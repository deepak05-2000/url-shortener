classDiagram
    class User {
        +String userId
        +String email
        +String passwordHash
        +DateTime createdAt
        +List~ShortenedUrl~ urls
        +register()
        +login()
    }

    class ShortenedUrl {
        +String shortCode
        +String originalUrl
        +DateTime createdAt
        +DateTime expiresAt
        +User owner
        +boolean isCustom
        +int clickCount
        +List~ClickAnalytics~ analytics
        +deactivate()
    }

    class ClickAnalytics {
        +DateTime timestamp
        +String ipAddress
        +String country
        +String deviceType
        +String browser
        +String referrer
    }

    class UrlShorteningService {
        +ShortenedUrl shortenUrl(originalUrl, [customCode])
        +redirect(shortCode)
        +getAnalytics(shortCode)
        +deleteUrl(shortCode)
    }

    class AnalyticsService {
        +List~ClickAnalytics~ getClicksByTimeRange(shortCode, start, end)
        +Map~String, Integer~ getGeoDistribution(shortCode)
        +Map~String, Integer~ getDeviceBreakdown(shortCode)
        +generateReport(shortCode)
    }

    class ShortCodeGenerator {
        +String generateRandomCode()
        +validateCustomCode(code)
    }

    class AnalyticsProcessor {
        +aggregateDailyStats()
        +detectAnomalies()
        +cachePopularUrls()
    }

    User "1" -- "*" ShortenedUrl : creates
    ShortenedUrl "1" -- "*" ClickAnalytics : has
    UrlShorteningService ..> ShortCodeGenerator : uses
    AnalyticsService ..> AnalyticsProcessor : uses
    UrlShorteningService ..> AnalyticsService : updates

    class UrlController {
        +createShortUrl()
        +redirect(shortCode)
        +getUrlInfo()
    }

    class AnalyticsController {
        +getClickStats()
        +getGeoData()
        +getDeviceData()
    }

    class SecurityConfig {
        +configureJwt()
        +configureHttpSecurity()
    }

    UrlController ..> UrlShorteningService : depends
    AnalyticsController ..> AnalyticsService : depends